(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{21:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-flex flex-fill flex-column content"},[i("div",{staticClass:"d-flex flex-column min-vh-75 p-2"},[i("nav",{staticClass:"navbar navbar-expand-lg flex-grow-4 px-0"},[i("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button"},on:{click:t.close_click}},[t._v("╳")]),t._v(" "),i("div",{staticClass:"flex-grow-1 justify-content-end text-right"},[t.save>0?i("button",{staticClass:"btn btn-success btn-sm",attrs:{type:"button"},on:{click:t.save_click}},[t._v("儲存")]):t._e()])]),t._v(" "),i("div",{staticClass:"input-group py-2"},[t._m(0),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.editorTitle,expression:"editorTitle"}],staticClass:"form-control flex-fill",attrs:{type:"text"},domProps:{value:t.editorTitle},on:{input:[function(e){e.target.composing||(t.editorTitle=e.target.value)},t.title_input]}})]),t._v(" "),i("ckeditor",{attrs:{editor:t.editor,config:t.editorConfig},on:{input:t.onEditorInput,ready:t.onEditorReady},model:{value:t.editorData,callback:function(e){t.editorData=e},expression:"editorData"}})],1)])};a._withStripped=!0;var n=i(28),o=i.n(n),r=i(55),s=i.n(r);function l(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var d=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.loader=e}var e,i,a;return e=t,(i=[{key:"upload",value:function(){return this.loader.file.then((function(t){return new Promise((function(e,i){var a=new FileReader;a.onload=function(){e({default:a.result})},a.onerror=function(){i(a.error)},a.readAsDataURL(t)}))}))}}])&&l(e.prototype,i),a&&l(e,a),t}(),u={name:"edit",data:function(){return{editorId:"",editorTitle:"",editor:s.a,editorData:"",editorConfig:{extraPlugins:[function(t){t.plugins.get("FileRepository").createUploadAdapter=function(t){return new d(t)}}]},save:0}},mounted:function(){},methods:{title_input:function(){this.save++},onEditorReady:function(t){var e=this;this.save=0;var i=this.$route.params.id;""===i||null==i?this.$router.push("/"):"new"==i?(this.editorId="",this.editorTitle="",this.editorData="",this.save=0):o.a.get("api/dataList",{data:{filters:{id:this.$route.params.id}}}).then((function(t){if(t.data.length){var i=t.data[0];e.editorId=i.id,e.editorTitle=i.title,e.editorData=i.content,e.save=Math.max(e.save-1,-1)}else e.$router.push("/")}))},onEditorInput:function(t){this.save=Math.min(this.save+1,1)},close_click:function(){this.save&&!confirm("尚未儲存是否離開")||(this.save=0,this.$router.push({name:"all"}))},save_click:function(){var t=this;""===this.editorId?o.a.put("api/dataList",[{title:this.editorTitle,content:this.editorData}]).then((function(e){e.data.length&&(t.editorId=e.data[0].id,t.$router.push({name:"edit",params:{id:e.data[0].id}})),t.save=0})):o.a.post("api/dataList",[{id:this.editorId,title:this.editorTitle,content:this.editorData}]).then((function(e){t.save=0}))}}},c=(i(56),i(8)),f=Object(c.a)(u,a,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[this._v("標題")])])}],!1,null,"6800aa52",null);f.options.__file="src/vue/pages/Edit.vue";e.default=f.exports},29:function(t,e,i){},56:function(t,e,i){"use strict";var a=i(29);i.n(a).a}}]);